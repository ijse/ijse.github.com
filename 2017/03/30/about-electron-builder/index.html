<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Electron builder æ‰“åŒ…å’Œè‡ªåŠ¨æ›´æ–° | &lt;ijse blog /&gt;</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.8f3ff9cb.css" as="style"><link rel="preload" href="/assets/js/app.7083a0a6.js" as="script"><link rel="preload" href="/assets/js/2.dbc5b6bb.js" as="script"><link rel="preload" href="/assets/js/27.a71b5170.js" as="script"><link rel="prefetch" href="/assets/js/10.aa528967.js"><link rel="prefetch" href="/assets/js/11.cd4e372e.js"><link rel="prefetch" href="/assets/js/12.acad8cb3.js"><link rel="prefetch" href="/assets/js/13.0b50a1ed.js"><link rel="prefetch" href="/assets/js/14.2cfaef07.js"><link rel="prefetch" href="/assets/js/15.81a10a57.js"><link rel="prefetch" href="/assets/js/16.c0ae58a7.js"><link rel="prefetch" href="/assets/js/17.00af3129.js"><link rel="prefetch" href="/assets/js/18.c10d6485.js"><link rel="prefetch" href="/assets/js/19.83d2a5b5.js"><link rel="prefetch" href="/assets/js/20.e47a9eae.js"><link rel="prefetch" href="/assets/js/21.a43eda65.js"><link rel="prefetch" href="/assets/js/22.a326597e.js"><link rel="prefetch" href="/assets/js/23.3ebd96c8.js"><link rel="prefetch" href="/assets/js/24.a3f15fd4.js"><link rel="prefetch" href="/assets/js/25.cfe6a959.js"><link rel="prefetch" href="/assets/js/26.ec7f25a6.js"><link rel="prefetch" href="/assets/js/28.9521d272.js"><link rel="prefetch" href="/assets/js/29.483b5a11.js"><link rel="prefetch" href="/assets/js/3.fd4fe1a3.js"><link rel="prefetch" href="/assets/js/30.897f1318.js"><link rel="prefetch" href="/assets/js/31.88fd91f0.js"><link rel="prefetch" href="/assets/js/32.5c0ba04f.js"><link rel="prefetch" href="/assets/js/33.1d89362a.js"><link rel="prefetch" href="/assets/js/34.5097aab8.js"><link rel="prefetch" href="/assets/js/35.99d727ca.js"><link rel="prefetch" href="/assets/js/36.38f9de3d.js"><link rel="prefetch" href="/assets/js/37.d19c094c.js"><link rel="prefetch" href="/assets/js/38.f8849e3d.js"><link rel="prefetch" href="/assets/js/39.d2aeb8c5.js"><link rel="prefetch" href="/assets/js/4.6c846dc1.js"><link rel="prefetch" href="/assets/js/40.ae795852.js"><link rel="prefetch" href="/assets/js/5.2b76bc80.js"><link rel="prefetch" href="/assets/js/6.b27b5285.js"><link rel="prefetch" href="/assets/js/7.f9c53605.js"><link rel="prefetch" href="/assets/js/8.263ca076.js"><link rel="prefetch" href="/assets/js/9.8a37ff1f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3ff9cb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container vuepress-theme-simple"><header class="header"><a href="/" title="" class="router-link-active">
      &lt;ijse blog /&gt;
    </a> <div style="clear: both"></div></header> <section class="post-view"><h1 class="post-title">
    Electron builder æ‰“åŒ…å’Œè‡ªåŠ¨æ›´æ–°
    <time datetime="2017-3-30" title="2017-3-30" pubdate="pubdate" class="post-date">
  1 year ago
</time></h1> <div class="content default"><p>æœ‰å…³Electron æ‰“åŒ…ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ–‡ç« ï¼Œä½†ä¸€äº›å·²ç»è¿‡æ—¶ï¼Œå¹¶ä¸é€‚ç”¨äºæœ€æ–°çš„ç‰ˆæœ¬ï¼Œåœ¨ç ”ç©¶çš„æ—¶å€™å› æ­¤è€Œèµ°äº†ä¸€äº›å¼¯è·¯ã€‚</p> <p>æˆªæ­¢æœ¬æ–‡ï¼Œæˆ‘ä½¿ç”¨çš„ç›¸å…³ç‰ˆæœ¬æ˜¯ï¼š
<ul><li>electron v1.6.4</li> <li>electron-builder v16.4.1</li></ul>
å¤§å®¶å¯ä»¥æ ¹æ®æƒ…å†µé˜…è¯»æœ¬æ–‡ã€‚</p> <h3>ä¸¤ç§ä¸»æµçš„æ‰“åŒ…å·¥å…·</h3>
å®˜æ–¹æ–‡æ¡£ä¸­ä¸¤ç§ä¸»è¦å·¥å…·æ˜¯electron-packagerå’Œelectron-builderï¼ŒåŒºåˆ«ä¸»è¦æ˜¯ï¼š
<ul><li>electron-packagerä¸»è¦æ˜¯ç¨‹åºæ‰“åŒ…ï¼Œå¹¶ä¸åŒ…å«ç”ŸæˆInstallerï¼Œä¸”ä¸èƒ½åœ¨Macä¸‹æ‰“åŒ…Winç¨‹åº</li> <li>electron-builderæ˜¯åŒ…å«äº†electron-packagerï¼Œèƒ½å¤Ÿç”ŸæˆInstallerï¼Œå¹¶ä¸”å¯ä»¥åœ¨Macå¹³å°ä¸‹æ‰“åŒ…Mac, Linuxå’ŒWindowsåŒ…</li></ul>
electron-builderå·¥å…·åŠŸèƒ½æ›´å¼ºå¤§ï¼Œä¸ä»…æ”¯æŒæ‰“åŒ…ï¼Œç”ŸæˆInstallerï¼Œè€Œä¸”è¿˜å¯ä»¥å‘å¸ƒåˆ°GitHubæˆ–S3ç­‰å¹³å°ï¼Œä¸”æ”¯æŒè‡ªåŠ¨æ›´æ–°ã€‚
<h3>electron-builderçš„æ–‡æ¡£</h3>
æ–‡æ¡£åœ°å€ï¼š[link](https://github.com/electron-userland/electron-builder/wiki)
<p>electron-builderä»£ç æäº¤å¾ˆæ´»è·ƒï¼Œæ›´æ–°è¾ƒé¢‘ç¹ï¼Œæ–‡æ¡£ä¹ŸåŒæ ·ğŸ˜”ã€‚</p> <p>åæ§½ä¸€ä¸‹å®ƒçš„<a href="https://github.com/electron-userland/electron-builder/wiki/Options" target="_blank" rel="noopener noreferrer">Options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>æ–‡æ¡£ï¼ŒååŠéƒ¨åˆ†è²Œä¼¼æ˜¯ä»ä»£ç æ³¨é‡Šä¸­è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£ï¼Œæ˜¯æ ¹æ®ä»£ç ç±»åæ’åºçš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä¸€èˆ¬çš„ç†è§£å’Œé…ç½®é¡ºåºï¼ŒæŸ¥çœ‹æ—¶å€™éœ€è¦å…³æ³¨å…¶é…ç½®é¡¹çš„åç§°å’Œç»§æ‰¿å…³ç³»ï¼Œå¹¶ä¸”æœ‰äº›é“¾æ¥æ˜¯åçš„ã€‚</p> <p>å®ƒæä¾›äº†ä¸¤ç§é…ç½®æ–¹å¼ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»é€šè¿‡<code>package.jsonè¿™ç§æ–¹å¼ã€‚</code></p> <p>å»ºè®®é˜…è¯»çš„é¡ºåºæ˜¯ï¼š
<ol><li><a href="https://github.com/electron-userland/electron-builder/blob/master/docs/Options.md#Metadata" target="_blank" rel="noopener noreferrer">Metadata<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è¿™éƒ¨åˆ†å†™çš„æ˜¯Package.jsonä¸­çš„é…ç½®é¡¹</li> <li><a href="https://github.com/electron-userland/electron-builder/blob/master/docs/Options.md#config--platformspecificbuildoptions" target="_blank" rel="noopener noreferrer">Config<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è¿™æ˜¯åœ¨package.json#buildä¸­çš„é…ç½®</li></ol>
åœ¨é˜…è¯»æ–‡æ¡£æ—¶ï¼Œæ³¨æ„Typeä¸€æ åˆ—å‡ºçš„é“¾æ¥ï¼Œç„¶åå†æœç´¢æ‰¾åˆ°ç›¸åº”çš„è¯¦ç»†é…ç½®éƒ¨åˆ†ã€‚ï¼ˆæœ‰çš„å¯èƒ½ä¸åœ¨æœ¬é¡µé¢å†…ï¼Œå¯ä»¥åœ¨æºç <code>packages/ç›®å½•</code>ä¸­å¯»æ‰¾ï¼‰
</p><h3>OSX Signing</h3>
Appçš„åˆ†å‘æœ‰ä¸¤ç§å½¢å¼ï¼š.appåŠ MASã€‚<p></p> <p>appä¸ç­¾åé»˜è®¤æ˜¯æ— æ³•è¿è¡Œçš„ã€‚</p> <p>æˆ‘ä»¬éœ€è¦è´­ä¹°ä¸€ä¸ªAppleå¼€å‘è€…è´¦å·ï¼Œå¹¶æœ¬åœ°ç”Ÿæˆä¸€ä¸ªå¯†é’¥ï¼Œç„¶åå¯¼å…¥è¯ä¹¦ã€‚
</p><blockquote>referï¼š<a href="https://github.com/nwjs/nw.js/wiki/MAS%3A-Requesting-certificates" target="_blank" rel="noopener noreferrer">link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></blockquote>
å¯¹äºå…¶å®ƒå¼€å‘è€…ï¼Œå¯ä»¥é€šè¿‡å¯¼å‡ºå¹¶åˆ†äº«.p12æ–‡ä»¶æ·»åŠ ã€‚
<h3>Windows Signing</h3><p></p> <div class="language-shell extra-class"><pre class="language-text"><code>âœ  my-app git:(master) âœ— makecert -sv my_win_private_key.pvk -n &quot;CN=MyWinCertificate&quot; -b 01/01/2017 -e 01/01/2027 -r my_win_certificate.cer
Mono MakeCert - version 4.6.2.0
X.509 Certificate Builder
Copyright 2002, 2003 Motus Technologies. Copyright 2004-2008 Novell. BSD licensed.

Success

âœ  my-app git:(master) âœ— pvk2pfx -pvk my_win_private_key.pvk -spc my_win_certificate.cer -pfx my_signing_key.pfx -po my_password
</code></pre></div><blockquote>refer: [link](https://www.npmjs.com/package/electron-installer-windows#signing)</blockquote>
é»˜è®¤Macä¸‹å®‰è£…monoåï¼Œåº”è¯¥ä¼šæœ‰<code>makecert</code>å’Œ<code>pvk2pfx</code>è¿™ä¸¤ä¸ªå·¥å…·ã€‚å¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥åˆ°Winä¸‹è¿›è¡Œç­¾åï¼Œæˆ–è€…ç›´æ¥ä»ç½‘ä¸Šä¸‹è½½ã€‚
<h3>æœ‰å…³è‡ªåŠ¨æ›´æ–°</h3>
electron-builderçš„è‡ªåŠ¨æ›´æ–°æœºåˆ¶ä¾èµ–çš„æ˜¯Squirrel.Macå’ŒSquirrel.windowsï¼Œå¹¶ä¸”æœ€æ–°ç‰ˆæœ¬å·²ç»å¯ä»¥å®ç°ä¸éœ€è¦å‡†å¤‡ä¸€å°æ¥å£æœåŠ¡å™¨ï¼Œåªéœ€è¦é™æ€æœåŠ¡å™¨ä¾¿å¯å®ç°ã€‚
<blockquote>Refer: [link](https://github.com/electron-userland/electron-builder/blob/master/docs/Auto%20Update.md)</blockquote>
ä¸€èˆ¬ï¼Œç”¨S3æ˜¯æ¯”è¾ƒçœå¿ƒçš„ï¼ŒæŒ‰ç…§æ–‡æ¡£é…ç½®å°±å¯ä»¥å®ç°Winå’ŒMacåŒå¹³å°çš„è‡ªåŠ¨æ›´æ–°ï¼Œåªéœ€è¦ä»£ç å“åº”ç›¸åº”äº‹ä»¶å³å¯ã€‚
<p>ä½†æˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ˜¯GitHub Private Repoï¼Œæœ‰é‰´æƒçš„é—®é¢˜ã€‚é‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯Nuts + GitHubï¼Œ Nutsä½œä¸ºæ›´æ–°æ¥å£ï¼ŒGitHubæä¾›å­˜å‚¨ã€‚</p> <p>ç›¸å…³é…ç½®å¦‚ä¸‹ï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;publish&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;provider&quot;</span><span class="token operator">:</span> <span class="token string">&quot;generic&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://down.ijser.cn/download&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;provider&quot;</span><span class="token operator">:</span> <span class="token string">&quot;github&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ijse&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;repo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desktop-app&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>è‡ªåŠ¨é™é»˜åå°æ›´æ–°å®ç°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> log <span class="token operator">=</span> global<span class="token punctuation">.</span>logger
<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> dialog <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> autoUpdater <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron-updater'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>autoUpdater

autoUpdater<span class="token punctuation">.</span>logger <span class="token operator">=</span> log
autoUpdater<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>transports<span class="token punctuation">.</span>file<span class="token punctuation">.</span>level <span class="token operator">=</span> <span class="token string">'info'</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    autoUpdater<span class="token punctuation">.</span><span class="token function">checkForUpdates</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    autoUpdater<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'update-downloaded'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> ret <span class="token operator">=</span> dialog<span class="token punctuation">.</span><span class="token function">showMessageBox</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>$mainWindow<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> <span class="token string">'question'</span><span class="token punctuation">,</span>
        buttons<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'é‡å¯å¹¶ä½¿ç”¨æ–°ç‰ˆæœ¬'</span><span class="token punctuation">,</span> <span class="token string">'ä¸‹æ¬¡æ‰“å¼€æ—¶å‡çº§'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        defaultId<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        cancelId<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        title<span class="token punctuation">:</span> <span class="token string">'æ–°ç‰ˆæœ¬å·²ç»å‡†å¤‡å¥½äº†'</span><span class="token punctuation">,</span>
        message<span class="token punctuation">:</span> <span class="token string">'é©¬ä¸Šé‡å¯å¹¶ä½¿ç”¨æ–°ç‰ˆæœ¬å—ï¼Ÿ'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        autoUpdater<span class="token punctuation">.</span><span class="token function">quitAndInstall</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3>è°ƒè¯•æ‰“åŒ…è¿‡ç¨‹</h3>
electron-builderéµå¾ªæƒ¯ç”¨çš„è°ƒè¯•æ—¥å¿—æ–¹å¼ï¼š
<pre class="lang:default decode:true ">NODE_ENV=electron-builder build</pre>
è¿™æ ·æ‰§è¡Œæ‰“åŒ…è¿‡ç¨‹åï¼Œä¼šè¾“å‡ºè¯¦ç»†çš„è¿‡ç¨‹æ—¥å¿—ï¼Œå¯¹è°ƒè¯•å¾ˆæœ‰å¸®åŠ©ã€‚
<h3>æœ€å</h3>
electron-builder å› ä¸ºæ–‡æ¡£æœ‰ç‚¹ä¸å¤ªå®Œç¾ï¼Œå®é™…å­¦ä¹ èµ·æ¥ä¼šæœ‰ç‚¹åƒåŠ›ï¼Œé‡åˆ°æ–‡æ¡£ä¸èƒ½å¾ˆå¥½è§£å†³çš„é—®é¢˜ï¼Œå¯ä»¥å»æŸ¥Issues å’Œ ä»£ç ï¼Œå¦å¤–ï¼Œå…³æ³¨Releasesæœ€æ–°ç‰ˆæœ¬å’Œå‘ç‰ˆè¯´æ˜ã€‚
</div> <!----></section> <footer class="footer"><!----></footer></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7083a0a6.js" defer></script><script src="/assets/js/2.dbc5b6bb.js" defer></script><script src="/assets/js/27.a71b5170.js" defer></script>
  </body>
</html>

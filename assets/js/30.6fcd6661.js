(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{340:function(t,v,_){"use strict";_.r(v);var e=_(46),i=Object(e.a)({},function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("p",[t._v("最近项目由于业务复杂度的不断提升，前端页面的数据层管理有些混乱和低效，出现数据更新同步复杂，数据源众多等问题。")]),t._v(" "),_("p",[t._v("vuex 对于一般复杂的前端组件共享数据是没什么问题的，但是当后端数据源复杂，数据需要进行复杂的合并、关联计算、预处理时，mutation 和 action 就会写得愈加复杂，同时团队成员也可能由于水平问题及对业务的不同角度理解，容易造成数据层混乱，使接下来新业务功能的开发越来越复杂，代码慢慢变得维护困难。")]),t._v(" "),_("p",[t._v("在这种背景下，似乎 RxJS 是不错的解决方案。")]),t._v(" "),_("h2",[t._v("问题")]),t._v("\n以下是我们在处理数据层时希望能够被解决好的问题：\n"),_("ul",[_("li",[t._v("异步的数据源")]),t._v(" "),_("li",[t._v("多种数据关联计算")]),t._v(" "),_("li",[t._v("需要最小范围更新（精准更新）")]),t._v(" "),_("li",[t._v("定时触发更新")])]),t._v("\n一个较理想的方式：我们把数据抽象包装为数据线，然后像接线一样将不同数据线连接到我们的处理模块及控制器上；当数据线上有数据通过时，直接推送到我们数据消费方，或者经过控制器，有选择地推送。\n"),_("p",[t._v("这其实就是消息订阅，是观察者模式的一种实现。\n")]),_("h2",[t._v("准备")]),t._v("\n官网：http://reactivex.io/rxjs"),_("p"),t._v(" "),_("p",[t._v("Dash Docset: https://github.com/royling/rxjs.docset\n")]),_("p",{attrs:{id:"JuCraDs"}},[_("img",{staticClass:"alignnone size-full wp-image-191 ",attrs:{src:"/uploads/img_5901888379484.png",alt:""}})]),_("p"),t._v(" "),_("h2",[t._v("V4 vs V5")]),t._v("\nGitHub中主要有两个RxJS版本实现，分别是：\n"),_("ul",[_("li",[t._v("V4： https://github.com/Reactive-Extensions/RxJS")]),t._v(" "),_("li",[t._v("V5：https://github.com/ReactiveX/rxjs\n"),_("p",{attrs:{id:"wlHVZCg"}},[_("img",{staticClass:"alignnone size-full wp-image-193 ",attrs:{src:"/uploads/img_5901c770e13e6.png",alt:""}})])])]),t._v("\nV5是最新的版本，二者在思想方面是一致的，V5版本主要优点是：\n"),_("ul",[_("li",[t._v("性能更好")]),t._v(" "),_("li",[t._v("调用堆栈输出更简洁，更易于调试")])]),t._v("\n详细对比：https://github.com/ReactiveX/rxjs/blob/master/MIGRATION.md\n"),_("p",[t._v("所以，现在更倾向使用V5版本。\n")]),_("blockquote",[t._v("使用npm安装RxJS 5: "),_("code",[t._v("npm install rxjs")])]),t._v(" "),_("h2",[t._v("梳理")]),t._v(" "),_("blockquote",[t._v("RxJS提供了各种API来创建数据流：\n"),_("ul",[_("li",[t._v("单值：of, empty, never")]),t._v(" "),_("li",[t._v("多值：from")]),t._v(" "),_("li",[t._v("定时：interval, timer")]),t._v(" "),_("li",[t._v("从事件创建：fromEvent")]),t._v(" "),_("li",[t._v("从Promise创建：fromPromise")]),t._v(" "),_("li",[t._v("自定义创建：create")])]),t._v("\n创建出来的数据流是一种可观察的序列，可以被订阅，也可以被用来做一些转换操作，比如：\n"),_("ul",[_("li",[t._v("改变数据形态：map, mapTo, pluck")]),t._v(" "),_("li",[t._v("过滤一些值：filter, skip, first, last, take")]),t._v(" "),_("li",[t._v("时间轴上的操作：delay, timeout, throttle, debounce, audit, bufferTime")]),t._v(" "),_("li",[t._v("累加：reduce, scan")]),t._v(" "),_("li",[t._v("异常处理：throw, catch, retry, finally")]),t._v(" "),_("li",[t._v("条件执行：takeUntil, delayWhen, retryWhen, subscribeOn, ObserveOn")]),t._v(" "),_("li",[t._v("转接：switch")])]),t._v("\n也可以对若干个数据流进行组合：\n"),_("ul",[_("li",[t._v("concat，保持原来的序列顺序连接两个数据流")]),t._v(" "),_("li",[t._v("merge，合并序列")]),t._v(" "),_("li",[t._v("race，预设条件为其中一个数据流完成")]),t._v(" "),_("li",[t._v("forkJoin，预设条件为所有数据流都完成")]),t._v(" "),_("li",[t._v("zip，取各来源数据流最后一个值合并为对象")]),t._v(" "),_("li",[t._v("combineLatest，取各来源数据流最后一个值合并为数组")])]),t._v("\n（from: https://github.com/xufei/blog/issues/44)")]),t._v("\n上面只是举例，实际RxJS提供了非常多的方法。"),_("p"),t._v(" "),_("p",[t._v("这里有一个非常棒的在线工具，将每个方法(operator)用marbles图画演示出来：\n")]),_("p",{attrs:{id:"fjcWFRQ"}},[_("img",{staticClass:"alignnone size-full wp-image-200 ",attrs:{src:"/uploads/img_5901e60e51254.png",alt:""}})]),t._v("\nhttp://rxmarbles.com/\n"),_("h2",[t._v("调试")]),t._v("\n在Devtools中调试异步代码通常都比较痛苦，目前可能最有效的方法仍是"),_("code",[t._v("console.log:")]),_("p"),t._v(" "),_("p",[t._v("添加"),_("code",[t._v('<code class="highlighter-rouge">.do(x =&gt; console.log(x))')]),t._v("在合适的结点。")]),t._v(" "),_("p",[t._v("另外， 还可以自己画流程图 或者 珠宝图。方法都比较原始，可能在阅读和调试别人的RxJS代码时仍会比较麻烦吧。")]),t._v(" "),_("p",[t._v("参考：https://staltz.com/how-to-debug-rxjs-code.html")]),t._v(" "),_("p",[t._v("> 有一个在线可视化调试工具：http://jaredforsyth.com/rxvision/，可惜作者已经不怎么维护了，并且它并不支持最新的RxJS V5版本。\n")]),_("h2",[t._v("资源")]),t._v("\n官网的Manual就是非常不错的入门教程：http://reactivex.io/rxjs/manual/overview.html"),_("p"),t._v(" "),_("p",[t._v("另外，其它一些资源可以从awesome-rxjs上去找。")])])},[],!1,null,null,null);v.default=i.exports}}]);